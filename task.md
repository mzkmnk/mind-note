# Obsidianライクマークダウンメモアプリ 実装計画書

## プロジェクト概要

Next.js + TypeScript + Tailwind CSSを使用して、Obsidianのようなマークダウン形式でメモを作成・管理できるWebアプリケーションを開発する。

## 現在の環境

- **フレームワーク**: Next.js 13.5.1 (App Router)
- **言語**: TypeScript 5.2.2
- **スタイリング**: Tailwind CSS 3.3.3
- **ランタイム**: Node.js
- **ブランチ**: cursor/document-implementation-plan-for-markdown-notes-03b4

## 機能要件

### 1. 基本機能
- [ ] マークダウンファイルの作成・編集・削除
- [ ] リアルタイムプレビュー機能
- [ ] ファイル一覧表示（サイドバー）
- [ ] 検索機能
- [ ] ダークモード対応

### 2. Obsidian風機能
- [ ] ウィキリンク記法（[[ファイル名]]）
- [ ] バックリンク表示
- [ ] グラフビュー（ノード間の関係性可視化）
- [ ] タグ機能（#tag）
- [ ] フォルダ階層管理

### 3. 高度な機能
- [ ] ローカルストレージでのデータ永続化
- [ ] エクスポート機能（MD、HTML、PDF）
- [ ] インポート機能
- [ ] ショートカットキー対応
- [ ] 全文検索

## 技術設計

### 1. アーキテクチャ

```
app/
├── components/           # 再利用可能なコンポーネント
│   ├── editor/          # エディタ関連
│   ├── sidebar/         # サイドバー関連
│   ├── preview/         # プレビュー関連
│   └── ui/              # UI基本コンポーネント
├── hooks/               # カスタムフック
├── lib/                 # ユーティリティ・ライブラリ
├── stores/              # 状態管理
├── types/               # TypeScript型定義
└── (pages)/             # ページコンポーネント
    ├── editor/          # エディタページ
    └── graph/           # グラフビューページ
```

### 2. 必要な追加パッケージ

```json
{
  "dependencies": {
    "react-markdown": "^8.0.7",           // Markdown レンダリング
    "remark-gfm": "^3.0.1",               // GitHub Flavored Markdown
    "remark-wiki-link": "^1.0.5",         // ウィキリンク対応
    "rehype-highlight": "^6.0.0",         // シンタックスハイライト
    "react-split-pane": "^0.1.92",        // 分割レイアウト
    "fuse.js": "^6.6.2",                  // 高速検索
    "zustand": "^4.4.1",                  // 軽量状態管理
    "lucide-react": "^0.279.0",           // アイコン
    "cmdk": "^0.2.0",                     // コマンドパレット
    "react-hotkeys-hook": "^4.4.1",       // ショートカット
    "d3": "^7.8.5",                       // グラフ可視化
    "@types/d3": "^7.4.0"
  }
}
```

### 3. データ構造

```typescript
interface Note {
  id: string;
  title: string;
  content: string;
  tags: string[];
  createdAt: Date;
  updatedAt: Date;
  path: string;
  links: string[];        // このノートから他のノートへのリンク
  backlinks: string[];    // このノートへの他のノートからのリンク
}

interface Folder {
  id: string;
  name: string;
  path: string;
  parentId?: string;
  children: (Folder | Note)[];
}
```

## 実装フェーズ

### Phase 1: 基盤構築（Week 1）
1. **プロジェクト初期設定**
   - 必要パッケージのインストール
   - 基本的なディレクトリ構造作成
   - TypeScript型定義

2. **レイアウト実装**
   - サイドバー + メインエリアのレイアウト
   - レスポンシブ対応
   - ダークモード切り替え

3. **状態管理セットアップ**
   - Zustandストア作成
   - ノート管理ストア
   - UI状態管理ストア

### Phase 2: 基本機能実装（Week 2）
1. **マークダウンエディタ**
   - テキストエディタコンポーネント
   - リアルタイムプレビュー
   - 分割表示切り替え

2. **ファイル管理**
   - ノート作成・削除機能
   - サイドバーでのファイル一覧
   - ローカルストレージ連携

3. **基本的な検索機能**
   - タイトル検索
   - 簡単なフィルタリング

### Phase 3: Obsidian風機能実装（Week 3）
1. **ウィキリンク機能**
   - [[記法]]の解析
   - ノート間リンク生成
   - 存在しないノートの自動作成提案

2. **バックリンク表示**
   - 各ノートへの参照一覧
   - リンク関係の双方向管理

3. **タグ機能**
   - #tag記法の解析
   - タグベースのフィルタリング
   - タグクラウド表示

### Phase 4: 高度な機能実装（Week 4）
1. **グラフビュー**
   - D3.jsを使用したノード関係図
   - インタラクティブな操作
   - フィルタリング機能

2. **全文検索**
   - Fuse.jsを使用した高速検索
   - ハイライト表示
   - 検索結果のランキング

3. **エクスポート・インポート**
   - Markdown形式でのエクスポート
   - 複数ファイルの一括処理

### Phase 5: UX改善・最適化（Week 5）
1. **ショートカットキー**
   - 一般的なエディタショートカット
   - 独自のナビゲーションキー

2. **パフォーマンス最適化**
   - 大量ファイル処理の最適化
   - 検索パフォーマンス向上
   - レンダリング最適化

3. **UI/UX改善**
   - アニメーション追加
   - ローディング状態改善
   - エラーハンドリング強化

## 技術的考慮事項

### 1. パフォーマンス
- 大量のノート（1000+）でも快適に動作するよう最適化
- 仮想化によるリスト表示最適化
- 検索インデックスのメモリ効率化

### 2. データ永続化
- 初期版はローカルストレージ使用
- 将来的にはファイルシステムAPI対応を検討
- バックアップ・復元機能

### 3. 拡張性
- プラグインシステムの基盤設計
- カスタムマークダウン記法への対応
- テーマシステム

### 4. アクセシビリティ
- キーボードナビゲーション対応
- スクリーンリーダー対応
- 色覚多様性への配慮

## 成功指標

- [ ] 100個以上のノートでも快適に動作
- [ ] 検索レスポンス時間 < 100ms
- [ ] モバイル対応（レスポンシブ）
- [ ] ダークモード完全対応
- [ ] ウィキリンク機能の完全実装
- [ ] グラフビューの実装
- [ ] エクスポート機能の実装

## リスク要因と対策

### リスク
1. **パフォーマンス問題**
   - 大量データでの動作不良
   - 対策: 仮想化、ページネーション実装

2. **ブラウザ制限**
   - ローカルストレージ容量制限
   - 対策: IndexedDBへの移行検討

3. **複雑性の増大**
   - グラフビュー実装の複雑さ
   - 対策: 段階的実装、シンプルなMVPから開始

### 対策
- 各フェーズ終了時の動作確認
- パフォーマンステストの実施
- ユーザビリティテストの実施

## 今後の拡張計画

### 短期（6ヶ月以内）
- [ ] リアルタイム共同編集
- [ ] クラウド同期機能
- [ ] モバイルアプリ（PWA化）

### 長期（1年以内）
- [ ] プラグインシステム
- [ ] AI機能統合（要約、関連ノート提案）
- [ ] 高度な可視化機能

---

**作成日**: 2024年現在  
**最終更新**: 実装開始前  
**担当者**: 開発チーム